# 《智能导游》功能分析 


---

## 前言
　　本文档是对《智能导游》功能的简单分析，使用markdown编写。文档包含对功能实现的方法与思路 以及 存在的疑问。本文档只对主要功能进行大概性的分析，还有很多细致的功能没有在文档中罗列。文档只做内部交流与确认，不做指导性用途。

##系统开发条件
 - Linux云主机，拥有公网IP地址。推荐使用ubuntu 14.04
 - 域名
 - 微信认证公众号
 - 景区3D模型，景点图片，景区地理信息

##功能分析

### 景区导游

 - 地图显示
 
    　　地图数据如何存入数据库，使用什么数据库？后台提供给前端的地图格式？地图是否可以缩放和拖放？

 - 兴趣点显示
 
    　　对景区建筑等进行分类，如景点，厕所等，用户可在页面上点击图标来高亮显示不同类别的建筑。

 - GPS定位
 
    　　使用微信js-sdk接口获取gps信息，微信内可控性低。

 - 景点讲解
 
    　　用户点击景点，页面显示景点文字说明，并提供语音播报，相册查看，导航至此处的按钮。

 - 路线推荐
 
    　　用户点击路线推荐按钮，地图高亮显示推荐路线。推荐路线可由景区方设定。

 - 路线导航
 
    　　**难点**！在不使用第三方地图软件情况下，如何计算？如何高亮显示路线？
 
   > 计算：路线交叉处为一个点，点与点的距离为权重。经典算法 **最短路径** 问题。使用**深度搜索算法**可解决

   > 显示：地图中的路线使用SVG矢量图。导航线路改变矢量图路径颜色

### 营销推广

 - 实时分享
 
    　　通过本平台，我们可以在景区地图上标记景点，并以`文字+图片`的形式分享到各大社交平台，如朋友圈，ｑｑ空间等。附加：是否需要收集这类信息保存到本平台？

 - 活动推广
 
    　　运用者登陆平台，撰写活动文章，通过平台群发到关注了公众号的用户。运营者应具备相关操作能力。

 - 在线购票
 
    　　公众号菜单里提供在线购票入口进入平台。默认使用微信支付，可选支付宝或银行卡支付。用户支付成功后平台自动生成电子票据。用户可在 `公众号菜单 -> 个人信息 -> 我的订单` 里查看

 - 交通指引
 
    　　关注者点击公众号菜单：`交通指引` 公众号自动回复图文信息。信息包括具体位置，附近车站等。

### 社区互动

 - 留言建议
 
    　　用户点击公众号菜单：`留言建议` 进入平台留言页面，撰写提交留言。

 - 粉丝互动
 
    　　用户点击公众号菜单：`粉丝互动` 进入平台互动页面，此功能以论坛的形式开放。
 
### 后台管理
 
 - 数据监控
 
    　　定时通过微信公众号向管理员推送　新增用户数量，用户活跃度，取消关注公众号用户数量等相关信息。

 - 数据分析
 
    　　系统统计平台各模块访问量；收集用户游玩路线，统计景区内各景点的访问量，计算各景点的权重；公众号向用户推送调查问卷；　景区负责人可根据信息对景区做出相应调整。
 　　
 - 数据管理
 
  - 地图数据管理
  
        　　增删改查

  - 用户管理
  
        　　*注册*： 微信用户通过扫描公众号二维码或者直接搜索关注本公众号。后台通过微信oauth2认证获取微信用户信息，每位微信用户有一个唯一的openid，后台为微信用户注册时使用次openid作为用户凭证，用户名使用微信用户名即可。
    
        　　*删除*： 数据库的用户表里有一个字段标识用户的状态`“正在关注/取消关注”`。用户取消关注公众号后，后台把记录的此字段的值改为“取消关注”。用户重新关注再把其改为“正在关注”。
